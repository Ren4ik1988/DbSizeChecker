# DbSizeChecker
Test project

Программа циклично извлекает информацию о размере баз данных PostgreSql и публикует в гугл-таблице. 

Настройка программы производится в файле конфигурации DbSizeCheker.exe.config (App.config). Доступны следующие настройки:
  1. Строка подключения к базе данных PostgreSql
  ```
  <connectionStrings>
    <clear />
    <add name="Server1"
     providerName="Ngpsql"
     connectionString="Host=localhost;Username=yourusername;Password=yourpassword" />
  </connectionStrings>
  ```
  Обрабатываются все строки подключения, в которых в качестве провайдера указан "npgsql"(регистр не учитывается). Имя параметра (name="Server1") используется при сохранении данных в гугл-таблице, а так же при рассчете свободного места в диске (пункт 3 инструкции).
  
  Для запуска программы должна быть указана как минимум 1 строка подключения к базе данных. 
  
  2. Имя пользователя
  
  ```
  <appSettings>
    ...
    <add key="Username" value="test"/>
    ...
  </appSettings>
  ```
  Указание имени пользователя не является обязательным. Если имя пользователя указано, авторизационные данные сервиса GooglSheets сохраняются для указанного пользователя и позволяют переключаться между разными учетными записями google без повторной авторизации посредством изменения параметра в файле конфигурации.
  Если параметр не указан, вход осуществляется под именем "default".
  
  3. Размер дисков
  ```
  <appSettings>
    ...
    <add key="Server1" value="10"/>
    ...
  </appSettings>
  ```
  Данный параметр указывает на размер диска, на котором расположен сервер. Указывается в гигабайтах. Значение параметра используется для рассчета свободного места на диске. Данные о размерах диска вносятся с ключом соответствующим параметру "name" строки подключения к базе данных.
  
  Отсутствие параметра в файле конфигурации не приводит к ошибке, но в этом случае в таблице в качестве свободного пространства будет указан размер 0 ГБ.
  
  4. Идентификатор таблицы в GoogleSheets
  ```
  <appSettings>
    ...
    <add key="GoogleTableId" value="" />
    ...
  </appSettings>
  ```
  Указание идентификатора таблицы не обязательно и, более того, не рекомендуется. При первом запуске приложения таблица создается автоматически и ее идентификатор сохраняется в вышеуказанном разделе. Если индетификатор таблицы введен врунчную и таблица с указанным в файле конфигурации идентификатором не найдена, будет создана новая таблица с заменой некорректной записи в конфигурации. 
  
  В программе не реализована проверка на доступность редактирования таблицы с подключаемой учетной записи, поэтому перед редактированием параметра вручную пользователю необходимо удостовериться, что у его учетной записи достаточно прав для чтения и внесения изменений в таблицу.  
  
  5. Интервал обновления данных.
  ```
  <appSettings>
    ...
    <add key="TimerInterval" value="30"/>
    ...
  </appSettings>
  ```
  
  По умолчанию программа через каждые 30 секунд инициирует новый запрос в базу данных и обновляет записи в таблице. Параметр позволяет изменить интервал обновления. Интервал указывается в секундах. 
